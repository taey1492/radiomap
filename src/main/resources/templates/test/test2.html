<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
  <title>Document</title>
</head>

<body>
  <p>아래에 표기되어야 하는데</p>


  <input type="file" id="fileInput">
  <button onclick="contourStart(json)">그래프출력</button>

  <div id="container"></div>
</body>

<script type="module" src="/JS/contour.js"></script>



</html>
<script>//파일읽는 스크립트
  document.addEventListener('DOMContentLoaded', function () {
    const fileInput = document.getElementById('fileInput');

    fileInput.addEventListener('change', function (e) {
      const file = e.target.files[0];

      if (!file) {
        return;
      }

      const reader = new FileReader();

      reader.onload = function (e) {
        try {
          //const json = JSON.parse(e.target.result);
          const data = json.json(e); //FileAttachment("/JS/volcano.json").json();

          const container = d3.select("#container");
          const n = data.width;
          const m = data.height;
          const width = 928;
          const height = Math.round((m / n) * width);
          const path = d3.geoPath().projection(d3.geoIdentity().scale(width / n));
          const contours = d3.contours().size([n, m]);
          const color = d3.scaleSequential(d3.interpolateTurbo).domain(d3.extent(data.values)).nice();

          const svg = d3
            .create("svg")
            .attr("width", width)
            .attr("height", height)
            .attr("viewBox", [0, 0, width, height])
            .attr("style", "max-width: 100%; height: auto;");

          svg.append("g")
            .attr("stroke", "black")
            .selectAll()
            .data(color.ticks(20))
            .join("path")
            .attr("d", (d) => path(contours.contour(data.values, d)))
            .attr("fill", color);
          // Append the SVG element.

          container.append(svg.node());
          console.log(json);
        } catch (err) {
          console.error('파일을 JSON으로 파싱하는 데 실패했습니다:', err);
        }
      };

      reader.onerror = function (e) {
        console.error('파일을 읽는 데 실패했습니다:', e);
      };

      reader.readAsText(file);
    });
  });
</script>